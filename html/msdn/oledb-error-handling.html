<h2>Обработка ошибок в OleDB</h2>
<p>Date: 04.01.2017 17:38:30</p>
<div>
<p>&nbsp;&quot;<em>Открывать и закрывать соединение при каждо&#1084; запросе нет необходи&#1084;ости и скорее всего пробле&#1084;атично с точки зрения производительности</em>.&quot;</p>
<p>Насколько я знаю, &#1084;еханика Ole DB авто&#1084;атически использует пул соединений.&nbsp;Операция закрытия&nbsp;соединения физически не освобождает ресурсы, связанные с ни&#1084;, поэто&#1084;у &#1084;ожно открывать и закрывать до посинения без потерь
 производительности. Хотя, надо конечно не закрывать в явно&#1084; виде а просто использовать using.</p>
</div>
<h2>Message 993</h2>
<p>Date: 20.01.2017 14:42:35</p>
<div>
<p>Выводить на экран ос&#1084;ысленное сообщение об ошибке &#1084;ожно, и нужно. При использовании програ&#1084;&#1084;ы пользователь далеко не всегда будет обращаться напря&#1084;ую в техподдержку разработчика, в первую очередь - к систе&#1084;но&#1084;у ад&#1084;инистратору.
 И для него будет полезно будет видеть технические данные ошибки. (Сообщение типа &quot;OleDbException: Не удалось получить доступ&nbsp;к файлу&quot; несет больше инфор&#1084;ации че&#1084; &quot;Что-то поло&#1084;алось&quot;).&nbsp;Просто надо сбалансировать
 ко&#1084;пактность сообщения и полноту инфор&#1084;ации. Для &#1084;еня, правильный шаблон обработки исключения должен выглядеть как-то так</p>
<pre class="prettyprint">try
{
	/* ... */
}
catch(Exception ex)
{
	MessageBox.Show(ex.GetType().ToString()&#43;&quot;: &quot;&#43;ex.Message&#43;&quot; в &quot;&#43;ex.Source, &quot;Ошибка&quot;);
	ErrorLog.WriteLine(DateTime.Now.ToString()&#43;&quot;. При выполнении операции (...) произошла ошибка:&quot;);
	ErrorLog.WriteLine(ex.ToString());	
}</pre>
<p>Если же принцип разработки &quot;лишь бы работало&quot;, используется технология WinForms или ASP.NET, и приложение однопоточное, исключения лучше вообще не обрабатывать. WinForms при необрабатывае&#1084;о&#1084; исключении са&#1084;а выводит сообщение с
 подробной инфор&#1084;ацией на экран. В случае ASP.NET пользователю выводится стандартное бесс&#1084;ысленное&nbsp;сообщение, а подробную инфор&#1084;ацию об ошибке IIS складывает в систе&#1084;ный журнал. К сожалению, это не работает в других типах приложений:</p>
<p><em>WPF</em> - при необрабатывае&#1084;о&#1084; исключении програ&#1084;&#1084;а падает с бесс&#1084;ысленны&#1084; систе&#1084;ны&#1084;&nbsp;сообщение&#1084; об ошибке.</p>
<p><em>Служба</em> - ошибка будет проигнорирована без какой-либо воз&#1084;ожности узнать что произошло</p>
<p><em>Многопоточное приложение WinForms</em> - ошибка в фоново&#1084; потоке будет также &#1084;олча проигнорирована</p>
<p>В обще&#1084;, обработка ошибок всегда - по ситуации.</p>
<p></p>
</div>
<h2>Message 990</h2>
<p>Date: 20.01.2017 17:10:05</p>
<div>
<p>&quot;<em>Поясните (что бы не искать) &quot;</em><span><span style="color:#000000"><em>ErrorLog</em></span></span><span><span style="color:#000000"><em>.</em></span></span><span><span style="color:#000000"><em>WriteLine</em></span></span><span><span style="color:#000000"><em>(</em></span></span><span><span style="color:#000000"><em>DateTime</em></span></span><span><span style="color:#000000"><em>.</em></span></span><span><span style="color:#000000"><em>Now</em></span></span><span><span style="color:#000000"><em>.</em></span></span><span><span style="color:#000000"><em>ToString</em></span></span><span><span style="color:#000000"><em>()&#43;...</em></span></span><span><span style="color:#000000"><em>&quot;.&nbsp;
 При вы&quot; - куда пишет</em>?&quot;</span></span></p>
<p>В &#1084;ое&#1084; при&#1084;ере ErrorLog это гипотетический класс,&nbsp;реализуе&#1084;ый програ&#1084;&#1084;исто&#1084;, который просто пишет лог в любое удобное &#1084;есто (напри&#1084;ер, в файл в&nbsp;папку с програ&#1084;&#1084;ой, в базу данных
 или в систе&#1084;ный журнал). Стандартного класса для ведения лога нет, но в любо&#1084; крупно&#1084; проекте обычно такой класс создается.</p>
<p>&quot;<em>И еще SQLException - аналогично? Мне кажется, что та&#1084; есть отличия: сначала SQL-сервер выдает ошибки, а топо&#1084; только в програ&#1084;&#1084;у попадает</em>.&quot;<span></span></p>
<p>При возникновении ошибки в SQL Servere действительно сналчала генерируется внутреннее исключение, которое &#1084;ожно обработать из кода&nbsp;Transact SQL. Но обычно это не нужно, если только не используется сложная логика транзакций. Так что&nbsp;обработка
 исключения SQL Server не отличается от обработки любых других исключений (кро&#1084;е того факта, что пара&#1084;етр Message этих исключений более инфор&#1084;ативен че&#1084; других, а в дополнительных данных исключения даже храниться идентификатор соединения
 и&nbsp;ссылка на страницу справки на сайте microsoft).</p>
<p><span><span style="color:#000000"></span></span></p>
</div>
<h2>Message 988</h2>
<p>Date: 20.01.2017 17:53:26</p>
<div>
<p>&quot;<em>Скаже&#1084;, в при&#1084;ере выше как Message так и Souce &#1084;огут быть пусты&#1084;и строка&#1084;и что выведет какую то абракадабру с точки зрения пользователя.&nbsp;</em><em>Да и са&#1084; по себе вывод MessageBox неудачен</em>&quot;</p>
<p>Я&nbsp;привел только как при&#1084;ер, передать суть алгорит&#1084;а. В реально&#1084; проекте надо конечно проверить на пустые строки и реализовать свое удобное&nbsp;окно сообщений.&nbsp;&nbsp;</p>
<p>&quot;<em>в результате пользователь скажет что е&#1084;у &quot;показали какую то ошибку</em>&quot;&quot;</p>
<p>От пользователя больше и не надо. Зная, когда и при како&#1084; действии возникла ошибка, специалист с&#1084;ожет найти в&nbsp;логе необходи&#1084;ую инфор&#1084;ацию.</p>
<p></p>
</div>
<h2>Message 987</h2>
<p>Date: 20.01.2017 19:40:15</p>
<div>
Для начала, &#1084;ожно просто создать центральную Access базу, в которую таблицы локальных баз будут добавлены как внешние ссылки. SQL-сервер тоже хорошо, если он уже развернут. (Если нет, только ради отчетов его развертывать наверно не стоит.)
</div>
