<h2>OleDB - Разделитель десятичной части чисел при работе с MS Access</h2>
<p>Date: 08.02.2021 3:45:26</p>
<div>
В фор&#1084;ате США запятая - это разделитель тысяч, а разделитель десятичной части - точка. Са&#1084; Access эти фор&#1084;аты обрабатывает отлично. Ошибка где-то при преобразовании &#1084;ежду тексто&#1084; и число&#1084; в ваше&#1084; коде.
</div>
<h2>Message 78</h2>
<p>Date: 08.02.2021 10:18:53</p>
<div>
Этот подход в корне неверен. Access при использовании и ODBC, и OleDB у&#1084;еет прини&#1084;ать сразу числовое значение нужного типа, никакого преобразования в строку вообще не должно фигурировать. Либо, если оно есть, оно должно осуществляться с предопределенны&#1084;
 CultureInfo, так что бы разделитель был известен.
</div>
<h2>Message 77</h2>
<p>Date: 08.02.2021 11:05:27</p>
<div>
Нет, это еще хуже. Надо передавать правильный CultureInfo в тот &#1084;етод, который осуществяляет преобразование (Double.Parse, Double.ToString, ...), а не устанавливать глобально. В каких-то других &#1084;етодах &#1084;ожет понадобиться и&#1084;енно
 систе&#1084;ная культура.
</div>
<h2>Message 76</h2>
<p>Date: 08.02.2021 16:13:57</p>
<div>
<p>Этот код нужно выкинуть и переписать по нор&#1084;ально&#1084;у. Здесь не преобразование в строку нужно, а использование пара&#1084;етризованных запросов:&nbsp;<a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/configuring-parameters-and-parameter-data-types">https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/configuring-parameters-and-parameter-data-types</a></p>
<p>Если запрос будет &quot;<span style="color:#333333; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; font-size:14px">INSERT INTO `t1` (`Число`) VALUES ('?')</span>&quot;, а значение передается через пара&#1084;етр (cmd.Parameters.AdddWithValue(&quot;param&quot;,<span style="color:#333333; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; font-size:14px">SERVDATA</span>)),то
 пробле&#1084;ы со знака&#1084;и разделителей не будет.</p>
<p>Как я уже написал, Access поддерживает передачу числовых значений напря&#1084;ую, без преобразования в строку, нужно лишь правильно ей воспользоваться</p>
</div>
<h2>Message 75</h2>
<p>Date: 09.02.2021 3:34:13</p>
<div>
Значения данных в запрос в любо&#1084; случае нужно вставлять пара&#1084;етра&#1084;и, не важно, строка это это или число. Да, если значение числовое, его нужно перевести в число с по&#1084;ощью той же культуры, с по&#1084;ощью которой его преобразовали
 в текст на сервере. Лучше использовать CultureInfo.InvariantCulture в&#1084;есто ru-RU, так как загрузка русского языка &#1084;ожет потребовать дополнительных ресурсов на не русскоязычной ОС, или вообще упасть с ошибкой, если какого-то пакета не хватает. Правильный
 подход и&#1084;енно такой.
</div>
<h2>Message 74</h2>
<p>Date: 10.02.2021 16:40:57</p>
<div>
Попробуйте са&#1084;и, и увидите, получиться или нет. InvariantCulture - это почти то же са&#1084;ое, что en-us, только для нее гарантируется, что она всегда доступна и ее пара&#1084;етры не зависят от настроек систе&#1084;ы и обновлений. То есть для передачи
 данных по сети это как раз то, что нужно. С использование&#1084; другой культуры &#1084;ожет получиться, но до поры до вре&#1084;ени.
</div>
