<html><head><title>Получение списка открытых файлов в Windows</title></head><body>
<p><a href="index.html">Ответы с форумов MSDN</a></p>
<h2>Получение списка открытых файлов в Windows</h2>
<p>Date: 03.11.2017 4:14:45</p>
<div>
<p>Систе&#1084;ные утилиты предположительно используют&nbsp;<a href="https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb525378(v=vs.85).aspx">NetFileEnum&nbsp;</a>для получения удаленно открытых файлов и &nbsp;<a href="https://forum.exetools.com/showthread.php?t=8711">NtQuerySystemInformation</a>&nbsp;для
 получения локально открытых файлов.</p>
<p>Однако, получение&nbsp;<strong>всех</strong>&nbsp;открытых файлов в систе&#1084;е - довольно затратная операция и обычно не нужна. Обычно более полезно получить инфор&#1084;ацию только о тех файлах, с которы&#1084;и програ&#1084;&#1084;а реально собирается
 работать. Это &#1084;ожно сделать с по&#1084;ощью функций&nbsp;RmRegisterResources / RmGetList из Restart Manager API.&nbsp;<a href="https://ru.stackoverflow.com/a/727180/240512">При&#1084;ер получения списка процессов, открывших указанный файл</a>.</p>
</div>
<h2>Message 621</h2>
<p>Date: 03.11.2017 4:40:15</p>
<div>
<p>Локально файлов открывается очень &#1084;ного даже без вашего ведо&#1084;а. У &#1084;еня ко&#1084;анда
<strong>openfiles /query &gt; file.txt</strong> выдает файл на 900&#43; строк (большинство - шрифты и всякие вре&#1084;енные файлы).</p>
<p>Но если нужны только удаленные то это легко должно делаться через NetFileEnum. Вот тут при&#1084;ер есть:&nbsp;<a href="https://www.codeproject.com/Articles/6426/WebControls/">https://www.codeproject.com/Articles/6426/WebControls/</a></p>
</div>
<h2>Message 620</h2>
<p>Date: 03.11.2017 5:22:11</p>
<div>
<p>Вот тут пос&#1084;отрите для c#&nbsp;<a href="http://www.pinvoke.net/default.aspx/netapi32.NetFileEnum">http://www.pinvoke.net/default.aspx/netapi32.NetFileEnum</a></p>
<p>openfiles это стандартная систе&#1084;ная утилита, в system32 лежит.&nbsp;</p>
<p>Можно кстати ее вывод парсить, если ва&#1084; так проще будет.</p>
</div>

<hr/><p>Автор: <a href="https://smallsoft2.blogspot.com">VadimTagil</a></p>
<p><a href="https://msdn-whiteknight.github.io/answers/html/">Главная страница</a> - <a href="index.html">Список тем</a> - <a href="https://github.com/MSDN-WhiteKnight/answers">Репозиторий на GitHub</a></p>
</body></html>
