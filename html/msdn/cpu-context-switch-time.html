<html><head><title>Процессор - Время переключения контекста потока</title></head><body>
<p><a href="index.html">Ответы с форумов MSDN</a></p>
<h2>Процессор - Время переключения контекста потока</h2>
<p>Date: 27.08.2018 11:39:51</p>
<div>
<p>На всякий случай уточню: на вопрос &quot;<span style="color:#333333; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; font-size:14px">Как снизить эту цифру?&nbsp;</span>&quot; ответ - &quot;Никак&quot;. Вре&#1084;я переключения
 контекста потока является константой для данного процессора (ну или, по крайней &#1084;ере для связки процессора и ОС).</p>
<p>Что касается влияния переключения контекста на производительность. Для того, чтобы понять это, нужно для начала понять, как &#1084;ногозадачные ОС управляют вре&#1084;ене&#1084; процессора. ОС выделяет каждо&#1084;у потоку по очереди интервал вре&#1084;ени
 (&quot;time slice&quot;), в течение которого он должен выполнить свою работу. Переключение контекста происходит при одно&#1084; из условий:</p>
<p>- По истечении этого интервала вре&#1084;ени</p>
<p>- Запуске другого потока с более высоки&#1084; приоритето&#1084;</p>
<p>- Запросе потоко&#1084; ожидания</p>
<p>При обычно&#1084; течении событий, когда все потоки работают с одинаковы&#1084; приоритето&#1084; и не часто запрашивают ожидание, срабатывает только первое условие. Так как величина time slice (~20 &#1084;с) на несколько порядков больше вре&#1084;ени переключения
 контекста (2-10 &#1084;кс), процент потерь на переключение контекста невелик.</p>
<p>Пробле&#1084;ы начинаются, когда проявляются 2 и 3 условия, напри&#1084;ер неисправное оборудование начинает слишко&#1084; часто генерировать прерывания (которые выполняются с высоки&#1084; приоритето&#1084;), либо в програ&#1084;&#1084;е &#1084;ного циклов
 со Thread.Sleep(1), которые часто переводят поток в состояние ожидания. Тогда переключение потоков действительно &#1084;ожет зани&#1084;ать большой процент процессорного вре&#1084;ени. Са&#1084;о по себе количество потоков &#1084;ало что значит, важно, что
 и&#1084;енно они делают.</p>
<p>Подробнее (по Windows) &#1084;ожете пос&#1084;отреть здесь:&nbsp;<a href="https://docs.microsoft.com/ru-ru/windows/desktop/ProcThread/about-processes-and-threads">https://docs.microsoft.com/ru-ru/windows/desktop/ProcThread/about-processes-and-threads</a>&nbsp;и&nbsp;<a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc938613(v%3dtechnet.10)">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc938613(v%3dtechnet.10)</a></p>
<p></p>
</div>
<h2>Message 391</h2>
<p>Date: 28.08.2018 4:48:20</p>
<div>
Такое средство вряд ли существует на уровне NET Core. В Windows, несо&#1084;ненно, есть средство, позволяющее обойти переключение контекста (приоритет реального вре&#1084;ени), но оно используется только в особых случаях.
</div>

<hr/><p>Автор: <a href="https://smallsoft2.blogspot.com">VadimTagil</a></p>
<p><a href="https://msdn-whiteknight.github.io/answers/html/">Главная страница</a> - <a href="index.html">Список тем</a> - <a href="https://github.com/MSDN-WhiteKnight/answers">Репозиторий на GitHub</a></p>
</body></html>
